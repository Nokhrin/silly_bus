# Преобразования типов в языке java

> Явные (эксплицитные) и неявные (имплицитные) преобразования типов в языке java



определения

преобразование типов данных
отображение значения одного типа в значение другого типа, допускаемое правилами рассматриваемой системы типов
правило, по которому значение типа А может быть представлено как значение типа В

явное преобразование
оно же - приведение или casting
способ преобразования, требующий синтаксической директивы программы
(целевой тип) значение

преобразование ссылочных типов может вызвать исключение ClassCastException
для примитивов может привести к потере точности
(int) 1.23 = 1

неявное преобразование
расширение - widening
выполняется компилятором - значения типа А преобразуются в значения типа В при условии, что множество значений типа А является подмножеством типа В
int -> long - от узкого к широкому диапазону значений

бытовой пример
даны стакан и кувшин

если стакан пуст, в кувшине вода - перелить воду в стакан - выполнить явное преобразование
исполнитель берет ответственность убедиться, что стакан вмести воду
(Стакан) стакан = кувшин

если в стакане вода, а кувшин пуст, то перелить воду из стакана в кувшин - неявное преобразование, подразумевается, что вода поместится
Кувшин кувшин = Стакан стакан


java
примитивные
явное
double d = 1.23
int i = (int) d

неявное
int i = 1
long l = I

ссылочные
неявное
Object obj = "java" // строка в объект
явное
String s = (String) obj // объект в строку

рассмотреть generics?

вопросы
явное показывает намерение, неявное - прячет логику?
явное - это костыль?
неявное - поведение по умолчанию, которое всегда верно и котором можно не думать?

почему java разрешает неявное расширение int->long и запрещает неявный кастинг long->int?
от какой ошибки защищает таким способом?

можно ли обойтись при проектировании системы без явных преобразований?
без неявных?

в каких случаях компилятор не может гарантировать сохранение семантики?

что такое безопасность в контексте неявного преобразования?


рассуждения
данные - последовательность бит - без типа не имеют смысла
неявные преобразования - гарантии языка по представлению данных, семантической корректеости
явные преобразования - признание языком возможности ошибки интерпретации данных


1
явное выражает осознанный выбор - есть риск потери информации
неявное расширяет тип, не изменяя значения

2
 программист использует явное преобразование, чтобы установить правила интерпретации существующего значения

3
неявное расширение не изменяет величину значения, сохраняет значение без потерь

4
тип и данные равны по значимости
тип - контракт о том, как интерпретировать нули и единицы - как читать значение и какие операции с ним допустимо выполнять

5
система может не использовать преобразования но такая детализация не оставит времени на бизнес логику, преобразования - компромисс между безопасностью и производительностью



boxing / unboxing рассмотреть